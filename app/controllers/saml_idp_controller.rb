class SamlIdpController < ApplicationController
  include SamlIdp::Controller

  before_filter :validate_saml_request

  def new
  end

  def create
    #@user = WellpointUser.find_by_id(params[:wellpoint_user][:id])
    @user = WellpointUser.first
    render :action => 'new' if @user.nil?
    
    #@saml_response = new_encode_SAMLResponse(@user.id, {}, get_custom_attributes(@user))
    @saml_response = WELLPOINT_SAML_RESPONSE

    render :action => 'response'
  end

  def new_encode_SAMLResponse(nameID, opts = {}, custom_attributes = "")
    
    now = Time.now.utc
    response_id, reference_id = UUID.generate, UUID.generate
    audience_uri = opts[:audience_uri] || saml_acs_url[/^(.*?\/\/.*?\/)/, 1]
    issuer_uri = opts[:issuer_uri] || (defined?(request) && request.url) || "http://example.com"

    assertion = %[<Assertion xmlns="urn:oasis:names:tc:SAML:2.0:assertion" ID="_#{reference_id}" IssueInstant="#{now.iso8601}" Version="2.0"><Issuer>#{issuer_uri}</Issuer><Subject><NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient">#{nameID}</NameID><SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"><SubjectConfirmationData InResponseTo="#{@saml_request_id}" NotOnOrAfter="#{(now+3*60).iso8601}" Recipient="#{@saml_acs_url}"></SubjectConfirmationData></SubjectConfirmation></Subject><Conditions NotBefore="#{(now-5).iso8601}" NotOnOrAfter="#{(now+60*60).iso8601}"><AudienceRestriction><Audience>#{audience_uri}</Audience></AudienceRestriction></Conditions><AuthnStatement AuthnInstant="#{now.iso8601}" SessionIndex="_#{reference_id}"><AuthnContext><AuthnContextClassRef>urn:federation:authentication:windows</AuthnContextClassRef></AuthnContext></AuthnStatement><AttributeStatement><Attribute Name="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"><AttributeValue>#{nameID}</AttributeValue></Attribute>#{custom_attributes}</AttributeStatement></Assertion>]

    digest_value = Base64.encode64(algorithm.digest(assertion)).gsub(/\n/, '')

    signed_info = %[<ds:SignedInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:CanonicalizationMethod><ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-#{algorithm_name}"></ds:SignatureMethod><ds:Reference URI="#_#{reference_id}"><ds:Transforms><ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform><ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform></ds:Transforms><ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig##{algorithm_name}"></ds:DigestMethod><ds:DigestValue>#{digest_value}</ds:DigestValue></ds:Reference></ds:SignedInfo>]

    signature_value = sign(signed_info).gsub(/\n/, '')

    signature = %[<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">#{signed_info}<ds:SignatureValue>#{signature_value}</ds:SignatureValue><KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#"><ds:X509Data><ds:X509Certificate>#{self.x509_certificate}</ds:X509Certificate></ds:X509Data></KeyInfo></ds:Signature>]

    assertion_and_signature = assertion.sub(/Issuer\>\<Subject/, "Issuer>#{signature}<Subject")

    xml = %[<samlp:Response ID="_#{response_id}" Version="2.0" IssueInstant="#{now.iso8601}" Destination="#{@saml_acs_url}" Consent="urn:oasis:names:tc:SAML:2.0:consent:unspecified" InResponseTo="#{@saml_request_id}" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol"><Issuer xmlns="urn:oasis:names:tc:SAML:2.0:assertion">#{issuer_uri}</Issuer><samlp:Status><samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" /></samlp:Status>#{assertion_and_signature}</samlp:Response>]

    Base64.encode64(xml)
  end

  private 

    def get_custom_attributes(user)
      attributes = [
        { name: 'hc_id',        value: user.hc_id.to_s },
        { name: 'cntrct_id',    value: user.cntrct_id.to_s },
        { name: 'mbr_sqnc_nbr', value: user.mbr_sqnc_nbr.to_s }
      ]

      attribute_statement = ''
      if attributes.count > 0
        attributes.each do |a|
          attribute_statement += %[<Attribute Name="#{a[:name]}" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic"><AttributeValue>#{a[:value]}</AttributeValue></Attribute>] 
        end
        attribute_statement
      end

      return attribute_statement
    end

    
    WELLPOINT_SAML_RESPONSE = "PFJlc3BvbnNlIHhtbG5zPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIERlc3RpbmF0aW9uPSJodHRwczovL3d3dy5xYTEubXlmaXRvcmJpdC5jb20vc2FtbC9jb25zdW1lIiBJRD0iXzFmYTMwYjNiOWFiNGZlMDdiYTMzZjU5YjUxNjdhMDljMzc1YyIgSXNzdWVJbnN0YW50PSIyMDEyLTExLTA5VDE5OjMyOjU0WiIgVmVyc2lvbj0iMi4wIj4NCiAgICA8bnMxOklzc3VlciB4bWxuczpuczE9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iIEZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOm5hbWVpZC1mb3JtYXQ6ZW50aXR5Ij5zYW1sLnVhdC5hbnRoZW0uY29tOkZpdE9yYml0PC9uczE6SXNzdWVyPg0KICAgIDxTdGF0dXM+DQogICAgICAgIDxTdGF0dXNDb2RlIFZhbHVlPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6c3RhdHVzOlN1Y2Nlc3MiLz4NCiAgICA8L1N0YXR1cz4NCiAgICANCjxuczI6RW5jcnlwdGVkQXNzZXJ0aW9uIHhtbG5zOm5zMj0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiI+PHhlbmM6RW5jcnlwdGVkRGF0YSB4bWxuczp4ZW5jPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyMiIFR5cGU9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI0VsZW1lbnQiPjx4ZW5jOkVuY3J5cHRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyN0cmlwbGVkZXMtY2JjIi8+PGRzOktleUluZm8geG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPg0KPHhlbmM6RW5jcnlwdGVkS2V5IHhtbG5zOnhlbmM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jIyI+PHhlbmM6RW5jcnlwdGlvbk1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3JzYS0xXzUiLz48eGVuYzpDaXBoZXJEYXRhPjx4ZW5jOkNpcGhlclZhbHVlPlZhZis3amRVSjg3bEpWV1VPQjd6bHU3NFZtaHh6WmY3SmZyQmk4MEs2NUJwTHFvTmFSVFFmeDI4L3JyeldmTWlBbkVnd1lxc2Zjek0NCmphWjJWTUJBVmwrY1ZxTHhudXpNVndDbHhYWDlnQmtoMEI0U3NIYURiVDJqRmNNMEhFRnVoZXhWVnViSG9KVW1JYjZtcFJWSGtTbVANCjFjaFA2Z04zNmE4bU5vVmUzM1k9PC94ZW5jOkNpcGhlclZhbHVlPjwveGVuYzpDaXBoZXJEYXRhPjwveGVuYzpFbmNyeXB0ZWRLZXk+PGRzOlg1MDlEYXRhPg0KPGRzOlg1MDlDZXJ0aWZpY2F0ZT4NCk1JSUNZekNDQWN3Q0NRQ0xRN1g5U1A4MGlEQU5CZ2txaGtpRzl3MEJBUVVGQURCMk1Rc3dDUVlEVlFRR0V3SlZVekVMTUFrR0ExVUUNCkNCTUNRMEV4RkRBU0JnTlZCQWNUQzB4dmN5QkJibWRsYkdWek1SSXdFQVlEVlFRS0V3bEdhWFJQY21KcGRDQXhGREFTQmdOVkJBc1QNCkMwVnVaMmx1WldWeWFXNW5NUm93R0FZRFZRUURFeEZ4WVM1dGVXWnBkRzl5WW1sMExtTnZiVEFlRncweE1qRXdNRGt5TXpRNU5UZGENCkZ3MHpNakV3TURReU16UTVOVGRhTUhZeEN6QUpCZ05WQkFZVEFsVlRNUXN3Q1FZRFZRUUlFd0pEUVRFVU1CSUdBMVVFQnhNTFRHOXoNCklFRnVaMlZzWlhNeEVqQVFCZ05WQkFvVENVWnBkRTl5WW1sMElERVVNQklHQTFVRUN4TUxSVzVuYVc1bFpYSnBibWN4R2pBWUJnTlYNCkJBTVRFWEZoTG0xNVptbDBiM0ppYVhRdVkyOXRNSUdmTUEwR0NTcUdTSWIzRFFFQkFRVUFBNEdOQURDQmlRS0JnUURXTXAzRWs3UnMNCmJLbWZIcVlSZVpTNmxCQlQ4NXMzaEhSK3d5blpFeUxvbHhCZ1I2WEFyTytDZGdMM3J2SmJZR2RvNFlIdjUzd2hvajdvZStMcnFFaFMNCnV0ZSsySlZnQ3pTWUt0aFM0MWpTcTVvV2kycTdkcHdYMmxhUkcrS1lWVzUrUWxDUW5UUmREd09nOHhEeGx5d1lXZkYySFlxRUhCdlkNCitYamk0d0ZGUndJREFRQUJNQTBHQ1NxR1NJYjNEUUVCQlFVQUE0R0JBR0FkVXZjejFHdGkwUzBpK0ZFYkFCTklOaW5NMTZrZTZaNFcNCkxKODVjU3dxMzhVOGZpelYxd0hVd1ZSbWVHTWwvRFFTaVlNVFAzNXJjNndYMTRwdUttNGhUWVNUUzZ5OGVSOTIvZDlJNm5BdVJoakkNCm9XUlJ5bVgrd1kvZTZ1ZW9iUDRUdmE0VEUrOWVQOVRPd0Nac1QxaGRCUnJ3Smw1MnN1cGpLR1p4WGVyQQ0KPC9kczpYNTA5Q2VydGlmaWNhdGU+DQo8L2RzOlg1MDlEYXRhPg0KPC9kczpLZXlJbmZvPjx4ZW5jOkNpcGhlckRhdGE+PHhlbmM6Q2lwaGVyVmFsdWU+ZzJwUHJ5Nlo1bFo1UE42cmVFK0Npb0JtN0lDYlNXZ1R2YXdTbHhZUUpmZG9ZNmpmWnN4c21jMzRqUEZRYStIOWJ0bjlvdlo4a2p6dQ0KRVNaMXhDVXl5OUoxeWJNUmZCR1RGckZTTDJiRmdrL2hOZU13VlNrQk8zS1pmTUJDcDZhZUI5WkZwOGFBOGFKQXVUbXdEVlIwN3p0RQ0Ka3F6VmtXalhZRmc2OWRYM05WaytxSExrNStDN1plRitWUysxdWk1VEJtUS9LbU9HanBZblg5SDUwVDBYWXhaTlFWeVRZa3YvcUF6QQ0KYk5SdnhGTUNtbVJuZkVzSlVoM1BmR2xvSzJhd3poYVlNSWFKWFE3Um5RdThIMmxGRkNyOTRSZ01ISmJJVVhVcXNReldZM2lNVStFNw0KTWVsdW5Nb0Fyck80ZlhEcTFyaVlkNjFhajREbExVSGttQlRCOE0wUkljNVRONUgwaUM3dzF0V1hqek95MERGcjNEUVdseGE2QndmZg0KVkdvMVI5QnFXTytBYUw4dFAwNWR6MUVOWU1JN292TUpYNkRFNWpRODIyYTdaZFkwUW91UE9TOW83bHZudEdXb3Z2aUVFY3NsclVvUA0KZ0pJU3dnaVpwN3h0UDMvWDNqY29yVGw3cEJJb1pHNDhKOTFpUXAzQnNuNEExRHZuY2hRa00wK3VXTmJ1VUdFUXJia2RxZzlqUmczLw0KQ2g4bUFZc2laRUZoQXE2TFlKYmpNaC9KSExEMjZta2xtMGdzWUdKYjBUd2VXa0svWnpTSlhNc2kwVm9meG04V0x2eVQyeHM4S3BlRw0KZTNkekJ2a1JyVkVaZFo1OU9KamkwTVVENHMrVmlVZER6a1B4a0l3QWVNc01XeldIbmx4VkxXODJMWGZyemdtSlZGdmtFM2JJdlphWA0Kbk12V1RYeFgrdmRpOGY3WHVmenNQcWx5ZjQ2aTVnRE5xQmlvbGRyQmJnL0xQOGhNOEk2VFphYUk4UUtEcVZZN2J4akxvdU9qSFVPZA0Kakwyako2QlBRcWtlWGZDU3hHMmRyZnlkYVNXSmtYSWptaUdTZkREOXZmNFBBT2NrV3JDbmdZTjFyMjREOVpHejhUaTQ0UTNQQlB3TA0KZDZiUTd3MlNVVWtaVThsZHZpQ1ROWHdkVEVod3pmOHliVnFFdXFoQUplckpZMENoYXVhVE0yMStYZzZ6bElVajZjdG5NLzFtQTVkOA0KakRxTmRHd1dvcXdyR3F1MHcwSEh6KzY2d0N5cVdwS2J1UEFvbnpwU2J2dTJ5elpFSEJuK0RsQjBVN2JuRy9OOUpQQ0ZCSG05WUMwVg0KM1FTc3kvN0E4U3NNckJPenphZEc5eUg2THpnL05sNG4xK0E0VXIwem5EOGdQKzFhRHQ3eUxScmNWd2N1eEl1V3dFTGVqSWNXeUZZQQ0KS2lIaDRlMWsvOFZ5WXpRU3BHTDFxRC9QNWJXVkNacDdMejBXbTJ6YkJ1elpSQ3JoM1FkKzhYY1J4clNONXl4UERHcllrVlpjeXcyYg0KWjJ1dUo4T016eWNVbk11Z25sazMxdzB4ZVNoRUc2dFBoQlBvdVRzZk9PY3BOb0ZiNUxOQnNSbE1jNFZVR2VERXJzTmxXNCtheHJNMw0Kcm9wR3J2M04xaVdJWFF5dm1tbjlqNVJDanJTYXRHZjhKaGhiWmEwdmV4c0pvL2JMWVY1L3Z2eW85aDZWaWJ2emRLMi9DaUp1UjdLMw0Ka0tyTGNoaWsrckVXVXZBSndyMTBJMitkejRTblBFbGNQRDV2TWlVNEpyVHRZelN2dndZVW1FbzdOM3h6dnJweHNZZ2p2eEdZNkcwaw0KWXpjcDNsYnhaaTNPRHIxTWR1QlI4NlRGaUpVenNhdUtaMzhYT0hBZ1Q2WCs4N29pbjA1cklwdFZjSVFzSWQ3Y2cyVlc3bWMwMVh6Nw0KR1RMNU40ZXJrNXczQTNRU3FZUU1PZ0YxRnRkalRrNGVHbUFrTk5lTDV1Vzl1K1dmVkQxajV4dkZVOFZUWW9kakxmSzhwOHJkNWwyNA0KQ0twVVJKSkpjNlovY0ZLeklIWGxrUm5qMVFrWlZ5T0FDTjNZdHNxczFEdFhTd3Evc0x2RzZTWVA0a2V5L3crUWlQSk4wc3dQc3YvcQ0KVkZyNUU5Z0x2ZHViTC93MnZvS0NRYWJLeHUxWTA2NVZnVGxxL20ra3lCN3R5VWFtM3I4UEx4RExRVGxmOUl4OUczN2M3Z3o1VjN2bw0KUXcyYTIvZFVYM1N5WGNIL2E2dnU5dlNKbU5aSXV0WFYyY21NUHlLdTBaM004Mk9FUFNuZGRyVHQvS2tCZlkwSmxKRDVwTHlpaTlaUg0KbnZmaG1xT3lDUjhUYzZ5RkEvaUZ2MFZpRFZyZmZCc1ZBRFhXWVVCSVlCRHU5Z3RCR1lhUTZlcDlnWVllS1U2cytLcjJ2bnBxRUJLWA0KaGFpb2xLNzRCaVB5ZVFteWxEWlluaHJUSnBteDU0Yi9YalpiK2N5ejBVeTF5dE8wMXpOMlhobVdyT2ltUUZtYktZWkc2cWlxZktlZQ0KbXoxOGl4Q3lxMzRkb3kybW5Wa2NjeVI0eVp1Tkg5djJITUMrWDcvc3B5QzFVd1QxU3B1RHdZdG9pdnA5YlNHMWgwSUZ3T05sNHhGKw0KaENXN1NPQmdYNWJ5TmpaOVBqOWg5cUtQTFBEZW5GdXRsWUx4cGQ4cytsZXVtd09laWVjZTF4NVVKMkd5aWc5eWdBV0FCc0RnZGRabA0KZWNLa2tCM2FBZFJnWmtIbU5XSzJSYmxueFVGaFY4djgvVmFFRUZjQUgvdUFveTdGeVpOZlAxZ1VpV0lHYUpldTZjTE5KalkrcGFkWQ0Kc1Fva3c5UWcxcWFUWWw2NExQMjc2WVBMVng0QXBsdmRyMWl0Ni8vU1lmbk4xMzBMZ1VQS1dEQ1dDZ09rV0VaOXpvOEF5bzdOYzJDWQ0KOXI1WElRSkV1eVpTYXdmYUE4YWZNZ2RKOVdTNkFxMW5id2dUQ3BEUHJUQlVLcnZFcDdFY2ZaL01Ya2hCbElzRnFzK0N6bGtiWHZMbg0KZ2JtbXFsQTNOaU9LbmhzaXBNaldHWi95c0hKSHhtRHNFeHByTFJpNzVMTUNZbXB2cW8yRCtWaSsyUEZZbFdqY2k3bGFmLzMzNmVsUA0KQmRtREQxRjAwUXFBMWtDK3hqVCtqT2doUGY5ZmJFZTBveEx6eFB0eHdoSlRKWW5OK25mQW91UWFmdEJmTU5jUEpxMXFIZDFQZUdZVg0KOGFjWUlsMHBkZzk3amhCQmZTYjVEcEZTR3l3QXlFYzhVNmpFa1g4cnM5Y2VWQkt4VDR2ZHB6Qi9JN1g2OUVwQzhWWUE4d09HbS9IQQ0KWUhCQXZRaVVjbmErTEQyQmJPVWFQTHRsNXhkRGNXR3AydW5ZbWE0VEJGMGsxZTVtQjh2bkVKam5LS1k1cDNreXFLa2o4VFBlaW81cA0KQXNFWjJta0s0cmJUcC9PSm8xdUZ0OGhveG1PNkYralBrSGFlNXVIRVhzenZIamJzdmtvU3B4eXJENVU1RW0yeHY5ZFp0UVNlUzlzaw0KL1hhWGduUEJYRmVyNHYya0lTaFEyVEYySlROa2c2YWVWL1RZZ1R1U0IyNjE1VkNGeGFEWnkzUHlPQ2dMdFZSVUd4Q0hLZ2hTcWtqRw0KYkJYa29zOVdGaUpGS1I5NDAyM0Z0R0pVU3dvdmx3WVpZeWxGdEI5UEcrMXdGQzBOR0pINmVCekpwbmtEWldCUEFua2pvdmtJd1YyTw0KaUdWT2x3WEgxb1V2QURpNDFQdk5lelB6R2lTVHFsTUhKbmJSb21FREdUdmNxYlQ0Mkg5OE0zQ3JRQU4zaXYxVk54SXBiczExbXV6OA0KTHFwb290NnNnQUxzbTNnM1EyVmpLRjRhR293bmJXM3ZqVG1kc0ZNSGMrbWhvMVZMMnFZL1FNcDJSL1lkTTViU2s4K3JoaXdQRWN2Yg0KRjBvSSthQ2ZFRlBYZUI1bldvanRYK2RQZmNjWC85dG0rSFhCZWhYeVRUZlhiNW1EaWgxaVNpaGorTUZNenU4QUhNTGM0dVc0SU9qUA0KWU40aHBpZTdVWWpHd0lCY21xalE1VDMrWDhwczB0bTRya3UvTFNPbXZwRzZaQnhuR0IvM3l1SjF4N1M0RTJTQUpGN1NsQk1EeXlndA0KMmRmVFhDbG5iYkNPcC94akV1V1RCeVdxcWg0RjVicWZ5dnNMSzc3V0pFN2FxeU11ZGs0WTZKWEx5QlJONm80bGQ5S2MwQXlCMEZQZA0KOCtYaVZYcE9Qb3BJcmVudFFodEpSdXBvOHNqdW0zenk3YzV0bzMwcWdnVTZWZ1JuenE1RjZkRmRGTFBkNHk5OWhwLzczckJ0d2VHWA0KMTk5YnVMVWNMN1AvN0UvaGxtRFNSTnprdkNtU0lmakVVMzFITnRvM1lZWE0vdis4dGhqZElKMysrWTF1dmFVanNWSmUxUU1MNkpnbg0KNUovRFFEWDFNb2xHRU5URURocktnMkJUZkd3N0lzeEFmem9odTd4S0ZoOWFoTXEvK2tkVGIwUWgvajFuZ0tTdytxK3dDWWRjSTZTbg0KSHFYeVlrWmhCeWttYVpna1BCWG80UlNzWWZNVUVMN25GRzJsdlhlbzk0ZmlLMlNIQXZUMkh2TzNRbWF3TmFjQityOXJML0Z1TWxlbg0KWUJ4VGJRWG9nMnNMMlU2VWNPSGlBK1grYUV3VFRNTGh6T0pkWHBDM1h1SkNTVCs2SklUZTdLZVUzYk1MSGJ4Qm85OWEwOU1OVTMvaA0KeUQ3QzJ0U25PTEJDa3QxN05CRjM4ck9RZncwQWNvRTFXS1MzeWxXdWZtNktsakZEUThMa3FXSTdLRHRYL2FaL2hneUtBVGk1TDlyTw0KNHlFYmJRS3JidThqTHFnT1phTnRCNnRBTTlFeWVKdkJaRVFlMzJOeFVJV0RHNmdUTjdWaTlHSDdGemMyNk5NNDZwM2JXa2R0bzAyMQ0KeXNyenVVKzFxeFVlR3c0YTF1cHMyZUMwTS9WWHZZMXZabFltV0RPMGllSmhJNEMvMDlqcEhLc253TEJTUXM2UnhnbHdwZzZKd2NpUA0KV0RUbThYcTlndHhnUXNsVllKeWVVdGh4N2xHLzYvOW1qNmFVNWlCZjZzc3pPS0ZhNmE4TVJUVENFZ1RWL3VWSjFqdDFpNmpFNkpMRw0KN2Y3ZHlZZ2t5aUZmcDV4cmJYOGJTUWxobHZjVUhwUE5QdWh4a0wzYlk2SHRhU01za1R1WHBvL2ZGcmNiakU0bFJudVhGbU81OGhWTQ0KallycjRENXJ1Nm5UQmhtVmFpc3I3NDI0OVBFUnp1eFRXaXk1clZwdzBWWWRwTFJqVGlNYXV6bmlyTlFlZEs5RS94SGc0VzRNSzZQVg0KSHZWN0lVc1BNaE1xOWtpT2hZYzU3Y0xhREZEWCsyblhWVHg3QUgrVTRtcWVLNTNyVFVvSEc0ZmVreTl6aElodHdKTkxMRHV5U0U5VA0KT0x1WDNkTW9WTkd0cHhicTkzSFgvbVpRNHRPSXE4VDhnSTlTb2JzOUY4eXZMdEk0UHJTV3hKMTIxSFNKZURWZ0NXNWRRdGwxTEtmaw0KSURwREYwNm9XdVFiTy91bXRmZ2V2YU42RGhGRFZwT0tCWnc3cEpxcElIdkNYeW5uQ0h1c2plSm9iNVpsM3U2MGc3VzM5SmdnL1RZdg0KbEVUSXd0bFltYWNaU2NJSVh2RnlzNW5jLzZqb2tzU09YenZPUEZpencvZ29hdU5qVHl0dS84TS9CSGR4bmYxV01jZlo1MkJhaG8yQg0KOXZ0cGFWWWttSGVNVkw0aldINjlFNURLUS9nMG0xa0I3MXAvZ2JVZ213bTNMQ2loK1JGMG03dDFFUElOTmh4RThKNzlZSzlnVGhzUQ0KcVJwS0xaSEsxRFBpcFpwUS90RG1YQU9WR0JWUUx6cTVZNUkxNnNOY0hqWnJ5QWd1RWhXR2lWSzZEa0ZHMXBwRC91RFc1YkZUYWRPKw0KdHNJelp3cVhRTlZLRDR0UDBEd2k3am80QXdrWnhDdks1clR4OCtMcEpuekI5eGh6cW1XK21MdnJBMnF2YTlSby81M0lFY3c5WTNpLw0KTFdOOHB3NTZCQkRzL0hXWmYzOTMvWGFSQ0VFVDVrNWsvL292THk5aUtFTmlCU3lqSk9uRDMxdDVxcE1FdHVublBwRWtkTWNvUThMbw0KVk8vZ1A1Zy9CdFh5UzY5NDNUV1RrbWVzbGNSUkd3ZXJabE9aT3JDU1FIYkdtWjI5MTFOaURzMjNyZDVMYnNyY01ZUS94a1lTV0o4Yg0KMncrN0toVHlmakNTUVo2VVIyU05kVThta3o0a1djYXRhQVlPMXlIQzR5NitWdVVwN3E4T3ZpZTRJRmM1cURKbVROOXM0VG16NFRMZQ0Ka2U0aXlHWTN0YlhRNGJHTU9HRnZqWjBpY0lweVdzenNCbjNyWTJORzllaEo2aElBbG45OEdoV0lSK1dRN0FaZDV4bW9TdHdtc2lSbw0KRG1Gc0tiVHFGc0w1SlBSQ1NvODBlanhIeG04cVNzZnIydlcvdTZPcmtscXcvYlkrTXB0UmlNU3ZlVnM0d3NOb0xOZmw0dmNGT1hzSw0KaTNtNTd0Y2d1cTE0MG1qSXUrTGg1Z3RsRDROb2hsd2NuOWlrd3dhVlF3WWxHTFgzRmpWbnZPcGQ5VHlqOFZEd3ptU2tlR01RbWcraQ0KTEIwVFA2eG8zSmJXQjZhSlFiREJxMmxwaElaOStHQ2dMYlpMTy9UVTNNSEJBSU5ZNklmK2NZa0h0dVJUL1lyR2l2aVpWVmVOWUhTYQ0KbllyY0M3QjlCT3pobUJDd256QTk4NHJDOUtZL3R1MUdveTdwVk9PanpSMGpMVGhDSzBxR2d0L3lBKy9XSnVzdTBFT3FCYkNiZDVMYw0KblJXcDJLWkphTWF1WnI3cmJHNUMrS1BpQWZhZGFqOUFadzJyV2c3ZkJnUnNZVW9GRVlIR3pYQTdmUHlvZTFkWXQ5dDlPSkVJZ3NNSA0KL2pvSzJYSVBBbFNlUTJUeW1YZElKd0ExUTVtK2VDMVZDZ21FSDVWSGFxS01ibS8vU29TTHc1eUlRUXlNcVRtUXpPNm02b2pwUlBXWA0KT3BDYjJYQTZZdndPL0tOU1Q4TGdvMFFRU1hCV082UzUyc1R1QlkyNjIvRlBscFY3eVVZV3Y0QWtNSXlDZ0dnN05mdlUwMXdNdjFsdQ0KeW95QTh4bEo0WUZRdjc2aDMvSzBVMHBjNjFTWTJIaFJuQUV3bGx0MkpPT2IwOHhhdGt4SDVzd1JveFM5N0VWaDR3dklIcHNwRVZsOA0KcGlTRU4ramszZGQ4eCtDaThISWVaaE1GNWtjNHovb2lXaGs4UUg2cnpnVGlaeExQTW5iQ3VBUkh0TUZBN1lCaXRadTlhUXFyTDRsaw0KSjVxVFd3RFpJaEhxKzJ6VFhiTDhFTkR5OTdldHVlMndkeGR2OFU0STRoSGZWZUdLMUd0Z0Q5NFNrelp0bFl2enB0dlN5R3hnMmRBNQ0KT05IYXUweGpTbG4rK0VjVHNWbElSUFg5RDB6M2xDbWkrNEdvMGNuTVpvQ0ViMmh5UVhVWnZoNmw1QVpsbzRoMk41N0J0RFpaQk92dA0KdXZMcy9ZR04rZnc5NUdrSnhhNGwxNCtrV0V4Mmx4RFcwL1RHcVV4Yi9GdFVoSG44Ujg3S2Rtbkp5YWI0cmx5ZFJLU3hHQkRxcXl3Uw0KS3VDVE1WYmhkM2JQcnVPb3F3eG04U2FvcjdXOHJreXpLWkhLTWd3M28xbDMvMUJqUTkwTXdtYXV5bGxmaCtZR0F0NHFWNEhjY21wdQ0KeGhrZ0MrNlRsN0MvMlZiazdxZlFhZWxrTnp0Q0RMTkw5VVhiRnYyMHdpMnF6UDhXenJYRm95OUoyM21UVU1Hb3p2ZHhZVCs0UUUxUw0KTzl1OEIrM0xmWmhjUkhCeDJNSEFZNnNoWVdzU05FMUNwUVdzUEZydUdtS0xWOEkrSVRsaG1QVFU2Zi90RmR5MU9ZaDRmM2VTYnFSQw0KQUVRVW05WkRKbkR3UTBuS2NuQXR1aVZ1OUVjVlFvOXZCVVQ3c2IxOUp0V3gzSWtCYWwyMElxZ1l0Wm40RVlwTHVhaWVnWTFnWm5VUA0KYW5veXdqcHd3Umw4RTVMMktHRmxNY3p2QUpXcFFaaUtXOTFJZzhkZjVLUEJrNTB3VXFNUDFZRXNlYW41YU8vMGk3WVlqa3g1c1Zzdw0KT1dETXcyT0djYzRNb3Q2K0kwcmtJanFxN0xZcjQzdFAyN2hqbXVNdWpvVDNOZXdXc0p1cGc5MXR0QXlCYU11RkowM0Urakh2azY0dw0KUHNXaTk3NWtTQU5iSTVQSTYzb3h4OXlFVThoU2tjcXJIRmhDQmNqRjhORDJsVldSY1FRaldCQ1djNzVEd2thbFVXL00vWTRhdWp5bg0KL2VkUTY0OGk2ZHdHcFZJZlN1YTh3M1ZDZnlOS2hENjFramZCOEVkcG1lalNWTkUzK05CVTg0VFJRMU0vdXdXL1QvR0VSTnFOZnZhMg0KZ2NQYkFwcnd4SXh0ZW9jcm9aWEdYNjl6YmlQWWlmb25GZXRUR0JGamQ4Y3NubTdkblJDd0NiMXd5WExDRnFLNGUvTGFkdHpvK3JaSw0KZXFzUkp6NEFxU2loSURGVlVoK0xrNXJWV2VjbFczSXhaYXY0OEc3UTVKS0F3a2RwM0x3Y0I4clJmaVlVWDlJdktnMkFEaVNJTmpaQQ0KdzkxYmRybjBRT1NLY3RCaFpLMENWR0s0a205ajhpcDVmaGpmTi9BQWRTVFkvUXExZk1RRHA4TXNMT1d4ckk2aUNOV2lzWUJDUWtYag0KZE11MUhmTnFxa2pTVzk4bTRKQnBoNnQvVnlrRUhTajJsQlpzdlYwWU5ON2tKdk12Tk9nTnNSV010UjhHU3hCSGNkTld4MkpOdFNULw0KbERIbENxd1FvMVk5eHRwQlk4RGNzM21Na2krY2lIMk9YZHRteVVmT2E0YlJ6QmVrU0xGZjVqdVZWcGh6V2ljQmZvdGZMQ2FWSjUvMg0KSWtRSlhyZzZCam1hOUxMbkxYaThZcXJmSTBiRjA0TklmY1NmaDF5aHhyNlN1YU9tL3MvVUpmQzRGdWhMWGlWbXhybWV1S204ZW1qMw0KamsxZzB5SVAzNTFCUWc1SHNhbVlXMTA4aVk0M0dqQmlPZjZvUUJHUGx6QW5Oa1M1S2ZiMUZRSENTb2VCV3hoLzNiTkI5WGNmUCtVVw0KaTJSN3BBaHErVy9HRC9kSmRSVkVaQU9KR0Vab2tYVDdhbVZ0cWE4TFVxK2crdUUwbDN6cTVDT0NGSkI3RGhxbk81b3c1L1RnTVZiWg0KWStPWlJRZ2gvaUo3VFB4SU0yb1VucjIrdHZuMmx5UmhuTUdKb2ZTc0pvbURhRE0ydFhRYXM1MjFQWStUN3ZGSlM3Y0ZidFJCeTBHUA0KOWplMWl2VmlBemNJTFMrUDdlcmozeFZ5OENwWW9SSDNtVmRJbU9KM3gvVW53QkxzY1FHTnRTUm5xeWxlV3dubXIrOHVJSUVoSlI3MA0KT1dVdFhhU3g0cGdMWDZuYXBNVytobWZvQW5pT0tISVAvdkNjRks4cHJjRGpwNGN1RlEwbkpDNWx5VHpXbnllMys5RkJUcGYyTGFqNw0KYXhmWlBuQ1ZIdGpvZ1NnMHk0OXJmR2hyZWloQU43MndnekRSemxqWGJVU0VTL1ZHU0JxR3VYb29pRG1WMWpScGg5UHYzQmRJU2s0Mw0KZzdPcE84TXo2eUpLSHcxRDhnZ1hVcm0xR01QSjZFb3kxV0czU3doa09qOFFyU25uOFpOa1pZODMvcXl1bStZTTZsN29TVnNSTXdVNw0KZ3pIRWp5TmVRbFJxYmoyNWEwTXI5T29Kd0ZjSGhhWURIc01MWWYxL3BuSzVsSk9KV01OS3R5MGJzT3RNbjBMUDVWK1JOMTNXY3NnVA0KT0FqSzZSY3RmY05tRTBla3R4cElnY3BUTEczWkxtYVZaUEtrTGFDcXEyUmc1cHFXbXN5K3lhd1VHK1RrU2h6OVlRU0JaYkZoL3p2Sw0Kdm9BU2tMZnFReVhCMDZ3T2lmdjg5SFV5amIzNTVHbmQvNUQzU3ZYUk9wTGtjRmVBVTJJamIwWVdkZ1JzVFBNeXY2aG5zbWhnVUQxbw0KSGxXM1ltcm9PdWVZTmRmRk91NmJkRlRGWmwydE0rblhHTXRPUzhBb2lCYXkyczBlOEVXZTV5TXVGc29OL1lzUEd0dEc2YjgxdkpKWQ0KOFloV2p2dS9wQ1l3MDRzOFRPTU1sNG9ubUxXVndmbUh4cXJwbGdGYkx2S2tDY0QvMzdMWExiL2JBRWFRcm83SURReVBNY3RReFMrWQ0Kd2d1V1dwcFoxdlpEYlhxK2NWTEFHRTBTSDI5ckgzU0M5c3BQVXd6SFBYM1MxOGdVRVIyejRqeHk2SWlXckFuczZmV3pVRFl3WG1BNg0KUTdEWnRKZmxZakpJK2NMbDNRY0JZdWc2MzFGR3ZUSjZ4NUJlOGFvRFROeXg1NW5VUVJraHY3SEFmcFl0cFlSUFpxN3NWQjhkQjRVMA0KMXVYUnVuSmk3Z0N6NzFtV1d5YlFyK3U0Y0VUd0YxK0hIbkhVc0crSno0MWJGQ2hhQXIrQUVqSFdPdkt4S21XZ2JuRnEzcHRUblY5MA0KQS8vVjRyNDI5YXlPd2FVNTcxdFV6MVVSWU5FR3dXKzRRSGxkd2hIQVdPRlY1c2hyanM4Y3R6elVtNk1FT0ZIeHhjcmx1bUxYcTdhaw0KZ0lFQk93U29wOXM3UlltZmJJd0kxbmlDUjJESkdKbHpHUTUzdGwxTE55VjBiOEFqZ1ZLZ3BCQzN2VjZMck95eTdndFVaZVpVUjEvdA0KYnN0QmdESXM2NmwrVDdZbSt3PT08L3hlbmM6Q2lwaGVyVmFsdWU+PC94ZW5jOkNpcGhlckRhdGE+PC94ZW5jOkVuY3J5cHRlZERhdGE+PC9uczI6RW5jcnlwdGVkQXNzZXJ0aW9uPjwvUmVzcG9uc2U+"

end